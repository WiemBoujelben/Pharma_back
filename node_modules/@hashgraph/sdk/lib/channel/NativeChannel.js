import t,{encodeRequest as e,decodeUnaryResponse as a}from"./Channel.js";import{encode as r,decode as o}from"../encoding/base64.native.js";import s from"../http/HttpError.js";import n from"../http/HttpStatus.js";class p extends t{constructor(t){super(),this._address=t}close(){}_createUnaryClient(t){return async(p,i,c)=>{try{const d=r(new Uint8Array(e(i))),l=await fetch(`${this._address}/proto.${t}/${p.name}`,{method:"POST",headers:{"content-type":"application/grpc-web-text","x-user-agent":"hedera-sdk-js/v2","x-accept-content-transfer-encoding":"base64","x-grpc-web":"1"},body:d});if(!l.ok){c(new s(n._fromValue(l.status)),null)}const b=await l.blob(),f=await new Promise(((t,e)=>{const a=new FileReader;a.readAsDataURL(b),a.onloadend=()=>{t(a.result)},a.onerror=e}));let h;if(f.startsWith("data:application/octet-stream;base64,"))h=o(f.split("data:application/octet-stream;base64,")[1]);else{if(!f.startsWith("data:application/grpc-web+proto;base64,"))throw new Error(`Expected response data to be base64 encode with a 'data:application/octet-stream;base64,' or 'data:application/grpc-web+proto;base64,' prefix, but found: ${f}`);h=o(f.split("data:application/grpc-web+proto;base64,")[1])}c(null,a(h.buffer,h.byteOffset,h.byteLength))}catch(t){c(t,null)}}}}export{p as default};
//# sourceMappingURL=NativeChannel.js.map
